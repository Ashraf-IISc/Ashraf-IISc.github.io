<!DOCTYPE html>
<html>
<head>
    <title>Gateway - The Grimoire</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <style>
        .auth-container { max-width: 400px; margin: 10vh auto; padding: 30px; background: var(--paper); border: 2px solid var(--accent); border-radius: 8px; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
        .auth-container h1 { text-align: center; margin-top: 0; color: var(--ink); border-bottom: 2px dashed var(--parchment); padding-bottom: 10px;}
        .auth-form { display: flex; flex-direction: column; gap: 15px; margin-top: 20px;}
        .auth-form input { padding: 10px; font-family: inherit; font-size: 1.2rem; border: 1px solid var(--parchment); border-radius: 4px; background: rgba(255,255,255,0.5); }
        .auth-form button { padding: 12px; background: var(--accent); color: var(--paper); border: none; border-radius: 4px; font-weight: bold; font-size: 1.2rem; font-family: inherit; cursor: pointer; transition: 0.2s;}
        .auth-form button:hover { background: var(--ink); }
        .auth-links { text-align: center; margin-top: 15px; font-weight: bold;}
        .auth-links a { color: var(--accent); text-decoration: none; transition: 0.2s;}
        .auth-links a:hover { color: var(--ink); }
        .error-msg { color: #d32f2f; font-weight: bold; text-align: center; background: rgba(211, 47, 47, 0.1); padding: 10px; border-radius: 4px; border: 1px solid #d32f2f;}
    </style>
</head>
<body>
    <div class="auth-container fade-in">
        {% if action == 'login' %}
            <h1>Enter The Grimoire</h1>
            {% if error %}<div class="error-msg">{{ error }}</div>{% endif %}
            <form class="auth-form" method="POST" action="/login">
                <input type="text" name="username" placeholder="Username" required>
                <input type="password" name="password" placeholder="Password" required>
                <button type="submit">Unlock</button>
            </form>
            <div class="auth-links"><a href="/register">Create a New Profile</a></div>
            
        {% elif action == 'register' %}
            <h1>Forge New Profile</h1>
            {% if error %}<div class="error-msg">{{ error }}</div>{% endif %}
            <form class="auth-form" method="POST" action="/register">
                <input type="text" name="username" placeholder="Choose a Username" required>
                <input type="password" name="password" placeholder="Choose a Password" required>
                <button type="submit">Forge</button>
            </form>
            <div class="auth-links"><a href="/login">&larr; Back to Gate</a></div>
            
        {% elif action == 'change' %}
            <h1>Alter Credentials</h1>
            {% if error %}<div class="error-msg">{{ error }}</div>{% endif %}
            <form class="auth-form" method="POST" action="/change_credentials">
                <input type="text" name="old_username" placeholder="Current Username" required>
                <input type="password" name="old_password" placeholder="Current Password" required>
                <hr style="border:0; border-top:1px dashed var(--parchment); width:100%;">
                <input type="text" name="new_username" placeholder="New Username" required>
                <input type="password" name="new_password" placeholder="New Password" required>
                <button type="submit">Transmute</button>
            </form>
            <div class="auth-links"><a href="/">&larr; Return to Grimoire</a></div>
        {% endif %}
    </div>
</body>
</html>